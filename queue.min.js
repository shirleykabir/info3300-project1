!function(b,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define(a):b.queue=a()}(this,function(){function e(){}function b(B){function g(){if(!v){try{q()}catch(f){z[A+C-1]&&m(f)}}}function q(){for(;v=n&&B>C;){var l=A+C,f=z[l],i=f.length-1,h=f[i];f[i]=o(l),--n,++C,f=h.apply(null,f),z[l]&&(z[l]=f||a)}}function o(f){return function(h,i){z[f]&&(--C,++A,z[f]=null,null==u&&(null!=h?m(h):(j[f]=i,n?g():C||x(u,j))))}}function m(i){var f,h=z.length;for(u=i,j=void 0,n=NaN;--h>=0;){if((f=z[h])&&(z[h]=null,f.abort)){try{f.abort()}catch(i){}}}C=NaN,x(u,j)}if(!(B>=1)){throw new Error}var k,v,z=[],j=[],n=0,C=0,A=0,u=null,x=e;return k={defer:function(h){if("function"!=typeof h||x!==e){throw new Error}if(null!=u){return k}var f=d.call(arguments,1);return f.push(h),++n,z.push(f),g(),k},abort:function(){return null==u&&m(new Error("abort")),k},await:function(f){if("function"!=typeof f||x!==e){throw new Error}return x=function(i,h){f.apply(null,[i].concat(h))},C||x(u,j),k},awaitAll:function(f){if("function"!=typeof f||x!==e){throw new Error}return x=f,C||x(u,j),k}}}function c(f){return b(arguments.length?+f:1/0)}var d=[].slice,a={};return c.version="1.2.3",c});